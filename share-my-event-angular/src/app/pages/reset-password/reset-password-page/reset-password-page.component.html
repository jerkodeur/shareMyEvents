<main class="mt-4">
  <app-flash-message></app-flash-message>
  <form [formGroup]="pwdForm" (ngSubmit)="onSubmit()" novalidate>
    <fieldset>
      <legend class="w-auto px-2">
        <h1>Réinitialiser le mot de passe</h1>
      </legend>
      <div class="required">* Champs obligatoires</div>
      <div class="form-group">
        <label for="code" class="form-label">Code reçu par e-mail <span class="text-blood">*</span></label>
        <input type="text" name="code" id="code" placeholder="Entrez le code" class="form-control"
               aria-required formControlName="code" autocomplete="code">
        <div class="error-feedback"
             *ngIf="submitted && pwdForm.controls['code'].errors && pwdForm.controls['code'].errors['required']">
          * Vous devez renseigner le code reçu par mail.
        </div>
        <div class="error-feedback"
             *ngIf="noMatch">
          * Code erroné, merci de renseigner un code valide.
        </div>
      </div>
      <div class="form-group">
        <label for="password" class="form-label" aria-required>Mot de passe <span class="text-blood">*</span></label>
        <div class="form-icon">
          <input [type]="pwdShow ? 'texte' : 'password'" name="password" id="password"
                 placeholder="Choisissez un mot de passe"
                 class="form-control" aria-required formControlName="password" aria-describedby="pwdHelp">
          <fa-icon [icon]="pwdShow ? faEyeSlash : faEye" size="xs" (click)="togglePwdType()"></fa-icon>
        </div>
        <div id="pwdHelp" class="form-text">
          Le mot de passe doit contenir au minimum 8 caractères, 1 majuscule, 1 minuscule, et 1 caractère spécial.
        </div>
        <div class="error-feedback"
             *ngIf="submitted && pwdForm.controls['password'].errors && pwdForm.controls['password'].errors['required']">
          * Vous devez renseigner un mot de passe.
        </div>
        <div class="error-feedback"
             *ngIf="submitted && pwdForm.controls['password'].errors && pwdForm.controls['password'].errors['pattern']">
          * Le format du mot de passe n'est pas correct.
        </div>
      </div>
      <div class="form-group">
        <label for="confirm_password" class="form-label">Confirmation du mot de passe <span
                class="text-blood">*</span></label>
        <div class="form-icon">
          <input [type]="cfPwdShow ? 'texte' : 'password'" name="confirm_password" id="confirm_password"
                 placeholder="Confirmer votre mot de passe"
                 class="form-control" aria-required formControlName="confirm_password">
          <fa-icon [icon]="cfPwdShow ? faEyeSlash : faEye" size="xs" (click)="toggleCfPwdType()"></fa-icon>
        </div>
        <div class="error-feedback" *ngIf="submitted &&
        !pwdForm.controls['password'].errors &&
             pwdForm.controls['confirm_password'].errors &&
             pwdForm.controls['confirm_password'].errors['matchPassword'] == true">
          * Les deux mots de passe ne sont pas identiques.
        </div>
      </div>
      <div class="row form-btn-layout">
        <button type="submit" class="btn btn-secondary">Confirmer</button>
      </div>
    </fieldset>
  </form>
  <div class="aside-link text-end">
    <p>Vous n'avez pas reçu l'e-mail pour la réinitialisation de votre mot de passe ?
      <br>
      <a routerLink="/password-reset/init">Recevoir un nouvel e-mail</a>
    </p>
  </div>
</main>
